import{r as n,j as e,z as m}from"./index-qQQjat6S.js";import{a as o}from"./api-egQaLHXj.js";import{F as b,y as d}from"./PlusIcon-Bg7ixw46.js";const F=()=>{const[p,j]=n.useState([]),[u,f]=n.useState([]),[y,c]=n.useState(!1),[a,l]=n.useState({name:"",description:"",permissions:[]});n.useEffect(()=>{x(),g()},[]);const x=async()=>{try{const s=await o.getRoles();j(s.data)}catch(s){console.error("Error fetching roles:",s)}},g=async()=>{try{const s=await o.getPermissions();f(s.data)}catch(s){console.error("Error fetching permissions:",s)}},N=async()=>{try{await o.createRole(a),c(!1),l({name:"",description:"",permissions:[]}),x()}catch(s){console.error("Error creating role:",s)}},h=s=>s.reduce((r,t)=>{const i=t.resource;return r[i]||(r[i]=[]),r[i].push(t),r},{});return e.jsxs("div",{children:[e.jsxs("div",{className:"sm:flex sm:items-center",children:[e.jsxs("div",{className:"sm:flex-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Roles"}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"Manage roles and their associated permissions in the system."})]}),e.jsx("div",{className:"mt-4 sm:mt-0 sm:ml-16 sm:flex-none",children:e.jsxs("button",{type:"button",onClick:()=>c(!0),className:"btn btn-primary inline-flex items-center",children:[e.jsx(b,{className:"-ml-1 mr-2 h-5 w-5","aria-hidden":"true"}),"Add Role"]})})]}),e.jsx("div",{className:"mt-8 space-y-8",children:p.map(s=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s.description})]}),e.jsxs("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-3 py-0.5 text-sm font-medium text-blue-800",children:[s.permissions.length," permissions"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Permissions"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Object.entries(h(s.permissions)).map(([r,t])=>e.jsx("div",{className:"relative flex items-start",children:e.jsxs("div",{className:"min-w-0 flex-1 text-sm",children:[e.jsx("p",{className:"font-medium text-gray-700",children:r}),e.jsx("ul",{className:"mt-1 space-y-1",children:t.map(i=>e.jsx("li",{className:"text-gray-500",children:i.name},i.id))})]})},r))})]})]},s.id))}),e.jsx(m,{appear:!0,show:y,as:n.Fragment,children:e.jsxs(d,{as:"div",className:"relative z-10",onClose:()=>c(!1),children:[e.jsx(m.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(m.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(d.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsx(d.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:"Create New Role"}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",id:"name",className:"input mt-1",value:a.name,onChange:s=>l({...a,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{id:"description",rows:3,className:"input mt-1",value:a.description,onChange:s=>l({...a,description:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Permissions"}),e.jsx("div",{className:"mt-2 space-y-4",children:Object.entries(h(u)).map(([s,r])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:s}),r.map(t=>e.jsxs("div",{className:"relative flex items-start",children:[e.jsx("div",{className:"flex h-5 items-center",children:e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",checked:a.permissions.some(i=>i.id===t.id),onChange:i=>{i.target.checked?l({...a,permissions:[...a.permissions,t]}):l({...a,permissions:a.permissions.filter(v=>v.id!==t.id)})}})}),e.jsxs("div",{className:"ml-3 text-sm",children:[e.jsx("label",{className:"font-medium text-gray-700",children:t.name}),e.jsx("p",{className:"text-gray-500",children:t.description})]})]},t.id))]},s))})]})]})}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:N,children:"Create"})]})]})})})})]})})]})};export{F as default};
